rule all:
    input:
        "cell-lines-microarray.png",
        "cell-lines-seq.png",
        "tcga-percentile.png",
        "tcga-RSEM.png"


rule plot_cell_line_microarray_expression:
    input:
        script = "cell-lines-microarray.R",
        data = "../../data/external/CCLE/CCLE_Expression_2012-09-29.res",
        affyids = "Affymetrix_U133_Plus_2-probe-IDs.tsv"
    output:
        "cell-lines-microarray.png"
    shell:
        "Rscript {input.script}"


rule plot_cell_line_seq_expression:
    input:
        script = "cell-lines-seq.R",
        data = "../../data/external/CCLE/CCLE_DepMap_18Q2_RNAseq_RPKM_20180502.gct"
    output:
        "cell-lines-seq.png"
    shell:
        "Rscript {input.script}"


rule affyids:
    input:
        script = "get-affyids.R"
    output:
        "Affymetrix_U133_Plus_2-probe-IDs.tsv"
    shell:
        "Rscript {input.script}"

rule ensembl_ids:
    input:
        script = "get-ensembl-genes.R"
    output:
        "ensembl-gene-IDs.tsv"
    shell:
        "Rscript {input.script}"

rule preprocess_tcga:
    input:
        script = "preprocess-tcga.R",
        data = "../../data/external/TCGA-PRAD/gdc_manifest_20180717_162017.txt"
    output:
        "tcga-aggregated.tsv"
    shell:
        "Rscript {input.script}"

rule tcga_percentiles:
    input:
        script = "calculate-tcga-expression-percentiles.R",
        tcga = "../../data/external/TCGA-PRAD/TCGA_Xena_PRAD.rds"
    output:
        "tcga-expression-percentiles.tsv"
    shell:
        "Rscript {input.script}"

rule plot_tcga:
    input:
        script = "plot-tcga.R",
        tcga = "../../data/external/TCGA-PRAD/TCGA_Xena_PRAD.rds",
        percentiles = "tcga-expression-percentiles.tsv"
    output:
        "tcga-percentile.png",
        "tcga-RSEM.png"
    shell:
        "Rscript {input.script}"
